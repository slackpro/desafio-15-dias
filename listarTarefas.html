<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Lista de tarefas</title>
  </head>
  <body>
    <script src="/topnav.js"></script>
    <!--
      listarTarefas.html
      - Página para visualizar, editar e deletar tarefas.
      - Chama `getLista()` em `script.js` para renderizar as tarefas do usuário.
    -->

    <div class="panel">
      <div class="panel-header">
        <h1>Lista de tarefas</h1>
      </div>

      <!-- Auth info shown in the navbar -->
      <ul id="montarLista"></ul>
      <div class="empty" id="emptyState">Carregando tarefas...</div>
    </div>
    <script type="module" src="/firebase-init.js"></script>
    <script src="/script.js"></script>
    <script>
      // tenta mostrar status de autenticação quando AppAuth estiver pronto
      (function () {
        let tries = 0;
        const iv = setInterval(() => {
          tries += 1;
          if (window.AppAuth) {
            window.AppAuth.onAuthStateChanged((user) => {
              // apenas recarrega a lista quando houver usuário; o banner é
              // atualizado pelo script compartilhado `auth-banner.js`.
              if (user && typeof getLista === 'function') getLista();
            });
            clearInterval(iv);
          }
          if (tries > 10) {
            clearInterval(iv);
          }
        }, 400);
      })();
      getLista();
    </script>
    <script src="/auth-banner.js"></script>
  </body>
</html>
